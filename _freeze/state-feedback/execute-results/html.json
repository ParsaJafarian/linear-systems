{
  "hash": "be80573f76406ac85cb236406cf3d90b",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Pole placement via statement feedback\n\nexecute:\n  echo: false\n  freeze: true\n  cache: true\n---\n\nConsider a SSM \n\\begin{align*}\n\\dot x(t) &= A x(t) + B u(t) \\\\\ny(t) &= C x(t)\n\\end{align*}\n\nIn this section, we will learning how to control such a system when the controller has access to the internal state $x(t)$. This is called **state feedback**. In the [next section](output-feedback.qmd), we will learn how to design a system when the controller has access to only the output $y(t)$. This is called **output feedback**.\n\n![Block diagram for state feedback](figures/svg/SSM1.svg){#fig-block}\n\nThe basic idea of state feedback is shown in @fig-block. The system has two tunable blocks: the **feedback gain** $K$ which is a $1 \\times n$ matrix and the **pre-compensator** $N$, which is a scalar. The equation for the input-output system may be written as:\n\\begin{align*}\n  \\dot x(t) &= A x(t) + B \\bigl( N r(t) - K x(t) \\bigr),  \\\\\n  y(t) &= C x(t),\n\\end{align*}\nor, equivalently,\n\\begin{align*}\n  \\dot x(t) &= (A - BK) x(t) + B N r(t),  \\\\\n  y(t) &= C x(t),\n\\end{align*}\nwhere $N \\in \\reals$ and\n$$\nK = \\MATRIX{k_0 & \\cdots & k_{n-1}}.\n$$\n\nWe will first consider the system without any input (i.e., $r(t) = 0$) and consider the zero input response. In this case, we only need to design $K$, which has $n$ tunable gains $k_0, \\dots, k_{n-1}$. The hope is that we can find these gain to arbitrarily choose the eigenvalues of the closed loop system. This is called **pole placement**.\n\nWe will start by looking at system in CCF and show that for such systems pole placement can be achieved by simply comparing coefficients of the characteristic polynomial of the open loop systems and the designed characteristic polynomial of the closed loop system. We will then look at systems that are not in CCF and show that if the system satisfies a condition known as **controllability**, we can find a transformation that converts the to CCF and use the results from state transformation to find $K$. \n\n\n\n## State feedback for systems in CCF\n\nConsider a state space system in CCF with \n$$\nA = \\MATRIX{\n0 & 1 & 0 & \\cdots & 0 \\\\\n0 & 0 & 1 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & \\cdots & \\cdots & 1 \\\\\n-a_0 & -a_1 & \\cdots & \\cdots & - a_{n-1}\n},\n\\quad\nB = \\MATRIX{0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ 1}.\n$$\n\nWe want to find a state feedback controller\n$$\nu(t) = -K x(t)\n\\quad \\text{where } \nK = \\MATRIX{k_0 & \\cdots & k_{n-1}}\n$$\nsuch that the characteristic polynomial of the closed loop system is\n$$\n\\det(sI - (A - BK)) =\ns^n + α_{n-1} s^{n-1} + \\cdots + α_1 s + α_0.\n$$\n\nObserve that \n$$\nB K  = \\MATRIX{0 \\\\ \\vdots \\\\ 0 \\\\ 1}\n\\MATRIX{k_0 & \\cdots & k_{n-1}} =\n\\MATRIX{\n0 & 0 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\vdots \\\\\n0 & 0 & \\cdots & 0 \\\\\nk_0 & k_1 & \\cdots & k_{n-1}\n}.\n$$\nThus, \n$$\nA - BK = \\MATRIX{\n0 & 1 & 0 & \\cdots & 0 \\\\\n0 & 0 & 1 & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & \\cdots & \\cdots & 1 \\\\\n-(a_0+k_0) & -(a_1+k_1) & \\cdots & \\cdots & -(a_{n-1} + k_{n-1})\n},\n$$\nwhich is in CCF. Thus,\n$$\n\\det(sI - (A - BK)) =\ns^n + (a_{n-1} + k_{n-1}) s^{n-1} + \\cdots + (a_1 + k_1) s + (a_0 + k_0).\n$$\n\nObserve that each component of the gain matrix $K$ affects only _one_ coefficient of the characteristic polynomial. Thus, we can pick\n$$\n\\bbox[5pt,border: 1px solid]\n{K = \\MATRIX{ α_0 - a_0 & \\cdots & α_{n-1} - a_{n-1}}}\n$$\nto place the poles of the closed loop system at any desired location.\n\n:::{#exm-CCF}\nConsider the system\n$$\nA = \\MATRIX{0 & 1 \\\\ -1 & -3},\n\\quad\nB = \\MATRIX{0 \\\\ 1}.\n$$\nDetermine a state feedback controller such that the eigenvalues of the closed loop system are at $-3 \\pm 2j$. \n:::\n\n:::{.callout-note collapse=\"true\"} \n#### Solution\n\nThe desired characteristic polynomial is\n$$(s + 3)^2 + 2^2 = s^2 + 6s + 13.$$\n\nThe current characteristic polynomial is (since the system is in CCF, we can determine it by inspection)\n$$\\det(sI - A) = s^2 + 3s + 1.$$\n\nThus, the required state feedback matrix is\n$$K = \\MATRIX{13 - 1 & 6 - 3} = \\MATRIX{12 & 3}.$$\n\nWe verify the solution below:\n\n::: {#e4971d30 .cell execution_count=3}\n``` {.julia .cell-code}\nA = [0 1; -1 -3]\nB = [0; 1]\np = [-3+2im -3-2im]\nK = place(A,B,p)\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\n1×2 Matrix{ComplexF64}:\n 12.0+0.0im  3.0+0.0im\n```\n:::\n:::\n\n\n:::\n\n## State feedback for systems not in CCF\n\nWhen a system is not in CCF, we can still use the design idea for systems in CCF if there exists a transformation (or change of coordinates) $x_c(t) = T^{-1} x(t)$ such that the system matrices for the system $(A_c, B_c, C_c)$ for $x_c(t)$ are in CCF. If such a transformation can be found, then we can find the gain matrix $K_c$ for the system in CCF using the method of the previous section and use[^K]\n$$ K = K_c T^{-1} $$\nas the gain for the original system. So, the main question is: how do we find such a transformation?\n\n[^K]: The state feedback in the new coordinate system is\n$$u(t) = - K_c x_c(t).$$\nSince $x_c(t) = T^{-1} x(t)$, we have\n$$ u(t) = - K_c T^{-1} x(t). $$\nTherefore $K = K_c T^{-1}$. \n\n### Controllability matrix\n\nThe controllability matrix of a state space system $(A,B)$ is defined as \n$$\\mathcal C_{(A,B)} = \\MATRIX{B & AB & \\cdots & A^{n-1} B }.$$\n\nNow consider a change of coordinates $x_c(t) = T^{-1} x(t)$. Recall that the state space representation in the new coordinate system is\n$$\nA_c = T^{-1} A T \\quad B_c = T^{-1} B.\n$$\nObserve that\n\n- $A_c^2 = T^{-1} A T T^{-1} A T = T^{-1} A^2 T$\n- $A_c^3 = T^{-1} A^2 T T^{-1} A T = T^{-1} A^3 T$\n- etc.\n\nTherefore,\n\n- $A_c^2 B_c =  T^{-1} A^2 T T^{-1} B = T^{-1} A^2 B$\n- $A_c^3 B_c =  T^{-1} A^3 T T^{-1} B = T^{-1} A^3 B$\n- etc.\n\nTherefore, the controllability matrix of the system in the new coordinates is\n\\begin{align*}\n\\mathcal C_{(A_c, B_c)} &=\n\\MATRIX{ T^{-1} B & T^{-1} A B & \\cdots & T^{-1} A^{n-1} B  }\n\\\\\n&= T^{-1} \\MATRIX{B & AB & \\cdots A^{n-1} B } \n\\\\\n&= T^{-1} \\mathcal C_{(A,B)}.\n\\end{align*}\n\nThus, we can go from the SSM $(A,B)$ to the SSM $(A_c, B_c)$ using the transformation\n$$\nT^{-1} = \\mathcal C_{(A_c, B_c)} \\mathcal C_{(A,B)}^{-1}\n$$\n_provided $\\mathcal C_{(A,B)}$ is invertible_ (i.e., has full rank). When that is the case, we say that the system is **controllable**. \n\nThere are different ways in which we can get uncontrollable models as is illustrated in the following example. \n\n:::{#exm-controllability}\nCheck if the following systems are controllable.\n\na. $A = \\MATRIX{2 & 0 \\\\ 0 & 3}$ and $B = \\MATRIX{0 \\\\ 1}$.\n\nb. $A = \\MATRIX{-4 & 5 \\\\ 0 & 9}$ and $B = \\MATRIX{-2 \\\\ 0}$. \n\nc. $A = \\MATRIX{1 & 5 \\\\ 8 & 4}$ and $B = \\MATRIX{-2 \\\\ 2}$. \n:::\n\n:::{.callout-note collapse=\"true\"} \n### Solution\n\na. We have \n   $$ A B = \\MATRIX{2 & 0 \\\\ 0 & 3} \\MATRIX{ 0 \\\\ 1} = \\MATRIX{0 \\\\ 3}.$$\n   Thus,\n   $$ \\mathcal C_{(A,B)} = \\MATRIX{ 0 & 0 \\\\ 1 & 3}. $$\n   We have $\\det \\mathcal C_{(A,B)} = 0$. So, $(A,B)$ is not controllable.\n\nb. We have \n   $$ A B = \\MATRIX{-4 & 5 \\\\ 0 & 9 } \\MATRIX{ -2 \\\\ 0} = \\MATRIX{8 \\\\ 0}.$$\n   Thus,\n   $$ \\mathcal C_{(A,B)} = \\MATRIX{ -2 & -8 \\\\ 0 & 0}. $$\n   We have $\\det \\mathcal C_{(A,B)} = 0$. So, $(A,B)$ is not controllable.\n\nc. We have \n   $$ A B = \\MATRIX{ 1 & 5 \\\\ 8 & 4} \\MATRIX{ -2 \\\\ 2} = \\MATRIX{8 \\\\ -8}.$$\n   Thus,\n   $$ \\mathcal C_{(A,B)} = \\MATRIX{ -2 & 8 \\\\ 2 & -8}. $$\n   We have $\\det \\mathcal C_{(A,B)} = 0$. So, $(A,B)$ is not controllable.\n\n:::\n\n### Pole Placement\n\nWe can use the above idea to design state feedback controller for systems not in CCF. In particular, the pole placement problem is as follows.\n\n:::{.callout-important}\n### Pole placement\n\nWe are given a SSM $(A,B)$ not in CCF and we want to find a state feedback controller \n$$\nu(t) = - K x(t), \\quad\n\\text{where } K = \\MATRIX{k_0 & \\cdots & k_{n-1} }\n$$\nsuch that the characteristic polynomial of the closed loop system is\n$$\n\\det(sI - A +  BK) = s^n + α_{n-1} s^{n-1} + \\cdots + α_1 s + α_0.\n$$\n:::\n\nWe present two methods for pole placement.\n\n### Method 1: Using controllability matrix\n\n1. Find the controllability matrix $\\mathcal C_{(A,B)}$ of the system. \n\n2. If the system is not controllable, i.e., the controllability matrix is not full rank (which can be tested by checking that the determinant of the controllability matrix is non-zero), pole placement is not possible and we quit the procedure. \n\n3. If the system is controllable, find the characteristic polynomial of $A$:\n   $$\\det(s I - A) = s^n + a_{n-1} s^{n-1} + \\cdots + a_0 $$\n\n4. Using the above characteristic polynomial, write the SSM $(A_c, B_c)$ in CCF.\n\n    [Recall that the characteristic polynomial is the denominator of the transfer function]{.text-smaller}\n\n5. Compute the controllability matrix $\\mathcal C(A_c, B_c)$ of the system $(A_c, B_c)$ in CCF.\n\n6. Compute the transformation\n    $$\\bbox[5pt,border: 1px solid]{\n    T^{-1} = \\mathcal C_{(A_c, B_c)} \\mathcal C_{(A,B)}^{-1}\n    }$$\n\n7. Compute the controller gain $K_c$ for the system in CCF:\n   $$ K_c = \\MATRIX{ α_0 - a_0 & \\cdots & α_{n-1} - a_{n-1}}. $$\n\n8. The controller gain for the original system is\n   $K = K_c T^{-1}.$$\n\n### Method 2: A slightly more efficient approach\n\nIt is possible to avoid the computation of the controllability matrix of the system in CCF by\nreplacing steps 4--6 of Method 1 by the following:\n\n4. Compute the matrix\n   $$ W = \\MATRIX{ a_1 & a_2 & \\cdots & a_{n-1} & 1 \\\\\n                   a_2 & \\iddots & \\iddots & 1 & 0 \\\\\n                   \\iddots & \\iddots & \\iddots & \\iddots & \\vdots \\\\\n                  a_{n-1} & 1 & 0 & \\cdots & 0 \\\\\n                  1 & 0 & 0 & \\cdots & 0 \n                 }\n   $$\n\n5. Compute the transformation:\n   $$\\bbox[5pt,border: 1px solid]{\n    T^{-1} = \\bigl[ \\mathcal C_{(A,B)} W \\bigr]^{-1}\n   }$$\n\n\n:::{#exm-pole-placement}\nConsider the following SSM:\n$$ A = \\MATRIX{3 & 1 \\\\ 1 & 2}, B = \\MATRIX{2 \\\\1} \\text{ and } C = \\MATRIX{ 3 & 2}. $$\nDesign a state feedback controller (i.e., compute the feedback gain $K$) such that the eigenvalues of the closed loop system are at $-2 \\pm 2j$. \n:::\n\n:::{.callout-note collapse=\"true\"} \n### Solution\nWe will show the solution via both method 1 and method 2. For method 1, we have the following.\n\n1. We have\n   $$ A B = \\MATRIX{3 & 1\\\\ 1 & 2} \\MATRIX{2 \\\\ 1} = \\MATRIX{7 \\\\ 4}. $$\n   Therefore,\n   $$ \\mathcal C_{(A,B)} = \\MATRIX{ 2 & 7 \\\\ 1 & 4}. $$\n\n2. $\\det \\mathcal C_{(A,B)} = 8 - 7 = 1 \\neq 0$. Thus, $(A,B)$ is controllable and we can design a state feedback controller. \n\n3. The characteristic polynomial is given by\n   $$s I - A = \\MATRIX{s & 0 \\\\ 0 & s} - \\MATRIX{3 & 1 \\\\ 1 & 2} = \\MATRIX{ s-3 & -1 \\\\ -1 & s - 2}.$$\n   Therefore,\n   $$\n   \\det(sI-A) = \\DET{ s-3 & -1 \\\\ -1 & s - 2} = (s-3)(s-1) - 1 = s^2 - 5s + 5.\n   $$\n\n4. The SSM in CCF is\n    $$ A_c = \\MATRIX{0 & 1 \\\\ -5 & 5}, \\quad B_c = \\MATRIX{0 \\\\ 1}.$$\n\n5. We have\n   $$ A_c B_c = \\MATRIX{ 0 & 1 \\\\ -5 & 5} \\MATRIX{0 \\\\ 1} = \\MATRIX{1 \\\\ 5}. $$\n   Therefore,\n   $$ \\mathcal C_{(A_c, B_c)} = \\MATRIX{0 & 1 \\\\ 1 & 5}. $$\n\n6. Thus, we have\n   \\begin{align*}\n    T^{-1} &= \\mathcal C_{(A_c,B_c)} \\mathcal C_{(A,B)}^{-1}\n    \\\\\n    &= \\MATRIX{0 & 1 \\\\ 1 & 5} \\MATRIX{2 & 7 \\\\ 1 & 4}^{-1} \n    \\\\\n    &= \\MATRIX{0 & 1 \\\\ 1 & 5} \\MATRIX{4 & -7 \\\\ -1 & 2}\n    \\\\\n    &= \\MATRIX{-1 & 2 \\\\ -1 & 3}.\n   \\end{align*}\n\n7. The desired characteristic polynomial is\n   $$ (s+2-2j)(s+2+2j) = (s+2)^2 + 2^2 = s^2 + 4s + 8. $$\n   Thus,\n   $$ K_c = \\MATRIX{8 - 5 & 4 - (-5)} = \\MATRIX{3 & 9}.$$\n\n8. Thus, \n   $$ K = K_c T^{-1} = \\MATRIX{3 & 9} \\MATRIX{-1 & 2 \\\\ -1 & 3} = \\MATRIX{-12 & 33}. $$\n\nWe can verify that the gain is correct.\n\n::: {#1380b04e .cell execution_count=4}\n``` {.julia .cell-code}\nA = [3 1;1 2]\nB = [2; 1]\np = [-2+2im -2-2im]\nK = place(A,B,p)\n```\n\n::: {.cell-output .cell-output-display execution_count=9}\n```\n1×2 Matrix{ComplexF64}:\n -12.0+0.0im  33.0+0.0im\n```\n:::\n:::\n\n\nFinally, we can redo the calculations using Method 2. In particular, instead of steps 4–6, we have\n\n4. Define\n   $$ W = \\MATRIX{ a_1 & 1 \\\\ 1 & 0 } = \\MATRIX{ -5 & 1 \\\\ 1 & 0 }. $$\n\n6. Therefore, \n   \\begin{align*}\n  T^{-1} &= \\bigl[ \\mathcal C_{(A,B)} W \\bigr]^{-1} \\\\\n  &= \\left( \\MATRIX{2 & 7 \\\\ 1 & 4} \\MATRIX{-5 & 1 \\\\ 1 & 0 } \\right)^{-1} \\\\\n  &= \\MATRIX{-1 & 2 \\\\ -1 & 3},\n  \\end{align*}\n\nThus, we get the same $T$ as using Method 1. The remaining steps 7 and 8 are the same as before. \n:::\n\n## State-feedback for reference tracking\n\nWe now return to the architecture shown in @fig-block and consider the design of the pre-compensator $N$. The idea is to choose the pre-compensator $N$ to ensure that steady state error is zero. In particular, we know that the DC-gain of the system is\n$$\n\\text{DC-gain} = N G(0) = N C (sI - (A - BK) )^{-1} B \\bigg|_{s = 0} = - N C (A-BK)^{-1} B.\n$$\nTo ensure that steady-state error when tracking a step input is zero, we pick the pre-compensator gain $N$ as follows:\n$$\n  N = - \\frac{1}{ C(A-BK)^{-1} B }.\n$$\n\n## Understanding lack of controllability\n\nIn this section, we provide some intuition to understand why controllability plays a critical role in state feedback. Consider the SSM\n\n\\begin{align*}\n\\dot x(t) &= A x(t) + B u(t) \\\\\ny(t) &= C x(t).\n\\end{align*}\n\nAs we saw in the [last section](matrix-exponential.qmd#time-response), the zero-state response of the system is\n$$\nx(t) = \\int_{0}^t e^{A τ} B u(t-τ)\\, d τ.\n$$\n\nWe already say that \n$$\n  e^{At} = I + At + \\frac{A^2 t^2}{2!} + \\frac{A^3 t^3}{3!} + \\cdots\n$$\nFrom [:Caley-Hamilton Theorem](https://en.wikipedia.org/wiki/Cayley%E2%80%93Hamilton_theorem), we know that any $A^k$ for $k \\ge n$ can be expressed in terms of $A^0, \\dots, A^{n-1}$. Thus, we can write\n$$\n  e^{At} = \\sum_{k=0}^{n-1} w_k(t) A^k\n$$\nfor some weight functions $\\{w_k(t)\\}_{k=0}^n$. \n\nHence, we can write the state $x(t)$ as\n\\begin{align*}\nx(t) &= \\int_{0}^t \\left( \\sum_{k=0}^{n-1} w_k(t) A^k \\right) B u(t - τ)\\, d τ \\\\\n&= \\sum_{k=0}^{n-1} A^k B \n\\underbrace{\\left[\\int_{0}^t w_k(t) u(t - τ)\\, d τ\\right]}\n_{\\eqqcolon v_k(t)} \\\\\n&= \\sum_{k=0}^{n-1} A^{k-1} B v_k(t) \n\\end{align*}\nwhere $v_k(t)$ denote on the control input $u(t)$. \n\nLet $M_c$ denote the range space of $\\mathcal C_{(A,B)}$. Then, by definition, for any input $u(t)$, \n$$\nx(t) = \\sum_{k=0}^{n-1} A^{k-1} B v_k(t) = \\mathcal C_{(A,B)} v(t) \\in M_c.\n$$\n\nSo, no matter what control inputs we use, we can only reach states belonging to $M_c$. If \n$$\\text{rank}(\\mathcal C_{(A,B)}) = \\text{rank}(M_c) \\neq n,$$\nthen there is a subspace that cannot be reached by any control input! This is actually the formal definition of controllability.\n\n:::{.callout-important}\n### Controllability\n\nA SSM is said to be controllable if for every initial condition $x_0$, time $t$, and state $x$ at time $t$, there exists a control input $u$ that moves the system starting at initial state $x_0$ to state $x$ at time $t$.\n\nThe argument presented above shows that a system is controllable if and only if $\\text{rank}(\\mathcal C_{(A,B)} = n$.\n:::\n\n### Uncontrollable modes of a system\n\n:::{#exm-uncontrollable}\nConsider\n$$\nA = \\MATRIX{-2 & 0 \\\\ 0 & -1}\n\\quad\\text{and}\\quad\nB = \\MATRIX{2 \\\\ 0}.\n$$\n\nThen,\n$$\\mathcal C_{(A,B)} = \\MATRIX{2 & -4 \\\\ 0 & 0 }.$$\nTherefore, \n$$\n\\text{range}(\\mathcal C_{(A,B)}) = \n\\left\\{ \\MATRIX{ α \\\\ 0 } : α \\in \\reals \\right\\}.\n$$\nThus, no matter what input we choose, we cannot reach vectors belonging to the subspace\n$$\n\\left\\{ \\MATRIX{ 0 \\\\ β } : β \\in \\reals \\right\\}.\n$$\n:::\n\nThe above example shows that for systems where $A$ matrix is diagonal, it is easy to interpret controllability: a system $(A,B)$ where $A$ is diagonal is uncontrollable if some element of $B$ is zero, which means that there is a _mode_ (i.e., eigen-direction) such that the input cannot effect the evolution of the state in that eigen-direction.\n\nLet's revisit the examples in @exm-controllability. Let $(λ_1, v_1)$ and $(λ_2, v_2)$ be the eigenvalue-eigenvector pairs for each model. Take $T = [v_1, v_2]$ and consider the change of variables $\\tilde x = T^{-1} x$. In this new coordinate system\n$$ \\tilde A = T^{-1} A T, \\quad \\tilde B = T^{-1} B. $$\nWe have that\n\na. We take $T = \\MATRIX{1 & 0 \\\\ 0 & 1}$. Thus, we have\n  $$\\tilde A = \\MATRIX{2 & 0 \\\\ 0 & 3}, \\quad \\tilde B = \\MATRIX{0 \\\\ 1}.$$\n\nb. We take $T = \\MATRIX{1 & 5 \\\\ 0 & 13}$. Thus, we have\n  $$\\tilde A = \\MATRIX{-4 & 0 \\\\ 0 & 3}, \\quad \\tilde B = \\MATRIX{-2 \\\\ 0}.$$\n\nc. We take $T = \\MATRIX{-1 & 5 \\\\ 1 & 8}$. Thus, we have\n  $$\\tilde A = \\MATRIX{-4 & 0 \\\\ 0 & 3}, \\quad \\tilde B = \\MATRIX{2 \\\\ 0}.$$\n\nThus, in all cases, there is an eigen-direction that cannot be controlled! \n\nFinally, we consider the following circuit to see why a physical system may be uncontrollable. \n\n![A RC-bridge](figures/svg/circuits9.svg){#fig-rc-bridge}\n\nWe will follow the approach presented in [previous section](state-space-models.qmd#ssm-for-circuits) to find a SSM for the circuit in @fig-rc-bridge. We take the voltage across the two capcitors (denoted by $v_1$ and $v_2$) as the two components of the SSM. From KCL, we have\n\\begin{align*}\n  C_1 \\dot v_1(t) &= \\frac{u(t) - v_1(t)}{R_1} - \\frac{v_1(t) - v_2(t)}{R_3} \\\\\n  C_2 \\dot v_2(t) &= \\frac{u(t) - v_2(t)}{R_2} + \\frac{v_1(t) - v_2(t)}{R_3}\n\\end{align*}\nwhich can be re-written in state-space form as:\n$$\\def\\1{\\vphantom{\\dfrac{1}{R_1C_1}}}\n  \\MATRIX{ \\1\\dot v_1(t) \\\\ \\1\\dot v_2(t) } =\n  \\MATRIX{ -\\left(\\dfrac{1}{R_1C_1} + \\dfrac{1}{R_3C_1}\\right) & \\dfrac{1}{R_3C_1} \\\\\n  \\dfrac{1}{R_3C_2} & -\\left(\\dfrac{1}{R_2C_2} + \\dfrac{1}{R_3C_2}\\right)}\n  \\MATRIX{ \\1v_1(t) \\\\ \\1v_2(t) }\n  + \n  \\MATRIX{\\dfrac{1}{R_1C_1} \\\\ \\dfrac{1}{R_2C_2}} u(t).\n$$\nConsider the difference $\\tilde v(t) = v_1(t) - v_2(t) = \\MATRIX{I & -I} \\MATRIX{v_1(t) \\\\ v_2(t)}$, which satisfies\n$$\n\\dot {\\tilde v(t)} = \n  -\\left[\\frac{1}{R_1C_1} + \\frac{2}{R_3C_1} \\right] v_1(t) \n  +\\left[\\frac{1}{R_2C_2} + \\frac{2}{R_3C_2} \\right] v_2(t) \n + \\left[ \\frac{1}{R_1C_1} - \\frac {1}{R_2C_2} \\right] u(t).\n$$\nWhen the bridge is **balanced**, i.e., $R_1 = R_2  = R$ and $C_1 = C_2 = C$, we have\n$$\n\\dot {\\tilde v(t)} = -\\left[ \\frac{1}{RC} + \\frac{2}{R_3 C} \\right] \\tilde v(t) \n$$\nwhich is a homogeneous equation with no input. Thus, in this case, the control input $u(t)$ has no impact on the subspace $v_1(t) - v_2(t)$ of the state space. Thus, the system is not controllable.\n\nWe can also verify this via the controllability matrix, whic is given by\n$$\n\\mathcal C = \\MATRIX{ \\dfrac{1}{RC} & -\\dfrac{1}{(RC)^2} \\\\\n\\dfrac{1}{RC} & -\\dfrac{1}{(RC)^2}}\n$$\nwhich is not full rank. \n\n\n\n### Uncontrollability and pole-zero cancellation\n\nUncontrollability is often related to pole zero cancelling. Consider the following transfer function:\n$$ G(s) = \\frac{s - z}{s^2 + 3s + 2}. $$\nLet's compare the CCF and OCF representations of the system:\n\n- **CCF representation**\n  $$ A_c = \\MATRIX{0 & 1 \\\\ -2 & -3 }, \\quad\n     B_c = \\MATRIX{0 \\\\ 1}, \\quad\n     C_c = \\MATRIX{-z & 1}.\n  $$\n\n- **OCF representation**\n  $$ A_o = \\MATRIX{0 & -2 \\\\ 1 & -3 }, \\quad\n     B_o = \\MATRIX{-z \\\\ 1}, \\quad\n     C_o = \\MATRIX{0 & 1}.\n  $$\n\nObserve that in the CCF representation the matrices $(A_c, B_c)$ do not depend on the location $z$ of the zero. Therefore, neither does the controllability matrix, which is given by\n$$\n  \\mathcal C_{(A_c, B_c)} = \\MATRIX{ 0 & 1 \\\\ 1 & -3 }\n$$\nOn the other hand, in the OCF representation the matrix $B_o$ depends on the location $z$ of the zero. Therefore, so does the controllability matrix, which is given by \n$$\n  \\mathcal C_{(A_o, B_o)} = \\MATRIX{ -z & -2 \\\\ 1 & -3 - z}.\n$$\nThus, $\\det \\mathcal C_{(A_o, B_o)} = z^2 + 3z + 2 = (z+1)(z+2).$$\nThus, the OCF representation is not controllable when $z = -1$ or $z = -2$!\n\nConsider z = -1$. For this value of $z$, the TF is given by\n$$\n  G(s) = \\frac{s + 1}{(s+1)(s+2)} = \\frac{1}{s+2}.\n$$\nThus, we have a pole-zero cancellation and the OCF representation is not controllable because of that!\n\nThis also suggests that we need to refine the relationship between characteristic polynomial of $A$ and the poles of the TF. The two are equal **when there is no pole-zero cancellation.** This also leads to the following definition.\n\n:::{.callout-tip}\n### Internal stability\n\nA SSM model $(A,B,C)$ is called **internally stable** if all the eigenvalues of $A$ lie in the OLHP. \n\nThis is equivalent to having all open loop poles like in the OLHP and no pole-zero cancellations taking place.\n:::\n\n\n### Properties of controllability\n\nWe conclude the discussion with some properties of controllability. \n\n:::{.callout-tip}\n### Properties of controllability\n\n1. **Change of coordinates does not change controllability.**\n\n   Let $T$ be an inverible matrix that changes the SSM $(A,B,C)$ to $(\\tilde A, \\tilde B, \\tilde C)$. Then, the system $(A,B)$ is controllable if and only if $(\\tilde A, \\tilde B)$ is controllable (we have seen this before when we derived a formula for $T^{-1}$.)\n\n2. **Invariance under state feedback**\n\n    The system $(A,B)$ is controllable if and only if the system $(A - BK, B)$ is controllable for all state feedback gains $K$.\n:::\n\nIs there a contradiction between the first claim (change of variables doesn't change controllability) and the pole-zero cancellation example above? No. Note that the claim is that **for an invertible matrix $T$.** In the example considered in the pole-zero cancellation section, the change of coordinates that take us from CCF to OCF is given by:\n$$\n  T^{-1} = \\mathcal C_{(A_o, B_o)} \\mathcal C_{(A_c, B_c)}^{-1}\n  = \\MATRIX{ -2 - 3z & - z \\\\ -z & 1 }.\n$$\nFor $z = -1$ or $z = -2$, the change of coordinates is not full rank!\n\n",
    "supporting": [
      "state-feedback_files"
    ],
    "filters": [],
    "includes": {}
  }
}